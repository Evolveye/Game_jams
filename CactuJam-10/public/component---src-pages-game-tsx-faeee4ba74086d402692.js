"use strict";(self.webpackChunkcactu_jam_10=self.webpackChunkcactu_jam_10||[]).push([[597],{8987:function(e,t,i){i.d(t,{A:function(){return r}});var s=i(6540);function r(e){let{component:t,layout:i}=e;return()=>s.createElement(i,null,s.createElement(t,null))}},297:function(e,t,i){function s(e){let{children:t}=e;return t}i.d(t,{A:function(){return s}})},120:function(e,t,i){i.r(t),i.d(t,{default:function(){return me}});var s=i(6540),r="game-module--mainCanvas--c69a1";function n(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var o=0;function a(e){return"__private_"+o+++"_"+e}function l(){return"undefined"==typeof window?null:window}let h=function(e){return e.CENTER="center",e}({});var A=a("ctxs"),c=a("entitiesCtx"),d=a("getEntitiesCtx"),u=a("getBestCtx"),v=a("resize");class g{constructor(){var e,t=this;Object.defineProperty(this,A,{writable:!0,value:[]}),Object.defineProperty(this,c,{writable:!0,value:void 0}),this.setCanvas=function(e,i){void 0===i&&(i=0),n(t,A)[A][i]=e.getContext("2d"),n(t,v)[v]()},Object.defineProperty(this,d,{writable:!0,value:()=>n(this,A)[A][n(this,A)[A].length-1]}),Object.defineProperty(this,u,{writable:!0,value:e=>n(this,A)[A].length>e?n(this,A)[A][e]:n(this,A)[A][n(this,A)[A].length-1]}),Object.defineProperty(this,v,{writable:!0,value:()=>{n(this,A)[A].forEach((e=>{const{canvas:t}=e;t.width=t.clientWidth,t.height=t.clientHeight}))}}),this.destroy=()=>{var e;null===(e=l())||void 0===e||e.removeEventListener("resize",n(this,v)[v])},null===(e=l())||void 0===e||e.addEventListener("resize",n(this,v)[v])}clear(e){void 0===e&&(e=null);const t=e=>{const{width:t,height:i}=e.canvas;e.clearRect(0,0,t,i)};e?t(e):n(this,A)[A].forEach(t)}drawLevel(e,t){let{mode:i=h.CENTER,tileSize:s=32}=void 0===t?{}:t;const r=n(this,A)[A],o=n(this,d)[d]();this.clear(),r.forEach((t=>{t.save(),i===h.CENTER&&t.translate((t.canvas.width-e.width*s)/2,(t.canvas.height-e.height*s)/2)})),e.forEach((e=>e.forEach(((e,t)=>null==e?void 0:e.draw(n(this,u)[u](t),s))))),e.entities.forEach((e=>e.draw(o,s))),r.forEach((e=>e.restore()))}}g.Mode=h;var f,p,w,m=a("data"),y=a("timeOfusedKeys");class E{constructor(e){void 0===e&&(e={}),Object.defineProperty(this,y,{writable:!0,value:{}});const t={},i={...E.predefinedBinds,...e};for(const s in i)t[s]=i[s].map((e=>"object"==typeof e?e:{code:e,result:!0}));this.binds=t}is(e){return E.is(e,this.binds).active}isOnce(e){const t=n(this,y)[y],{active:i,updatedAt:s}=E.is(e,this.binds);return(!(e in t)||t[e]!==s)&&(!!i&&(n(this,y)[y][e]=s,!0))}}f=E,Object.defineProperty(E,m,{writable:!0,value:{}}),E.predefinedBinds={controls:[{code:"KeyW",result:"up"},{code:"ArrowUp",result:"up"},{code:"KeyD",result:"right"},{code:"ArrowRight",result:"right"},{code:"KeyS",result:"down"},{code:"ArrowDown",result:"down"},{code:"KeyA",result:"left"},{code:"ArrowLeft",result:"left"}],leftDirection:["KeyA","ArrowLeft"],rightDirection:["KeyD","ArrowRight"],upDirection:["KeyW","ArrowUp"],downDirection:["KeyS","ArrowDown"]},E.is=function(e,t){var i;void 0===t&&(t={});const s=n(f,m)[m];/^[a-z]$/i.test(e)?e=`Key${e.toUpperCase()}`:/^[0-9]$/.test(e)?e=`Digit${e}`:["up","right","down","left"].includes(e)?e=`Arrow${e.charAt(0).toUpperCase()+e.slice(1)}`:"shift"===e&&(e="ShiftLeft");let r=s[e];if(!r&&e in t){const i=t[e].find((e=>{var t;let{code:i}=e;return null===(t=s[i])||void 0===t?void 0:t.active}));if(i){r={...s[i.code],code:i.code}}}return null!==(i=r)&&void 0!==i?i:{code:e,active:!1,updatedAt:0}},E.onKeyDown=e=>{var t;let{code:i}=e;null!==(t=n(f,m)[m][i])&&void 0!==t&&t.active||(n(f,m)[m][i]={code:i,active:!0,updatedAt:Date.now()})},E.onKeyUp=e=>{let{code:t}=e;n(f,m)[m][t]={code:t,active:!1,updatedAt:Date.now()}},null===(p=l())||void 0===p||p.addEventListener("keydown",E.onKeyDown),null===(w=l())||void 0===w||w.addEventListener("keyup",E.onKeyUp);var b=a("framesCount"),O=a("framesPerRow"),C=a("framesPerColumn"),R=a("spreadsheet"),B=a("currentFrame"),U=a("frameWidth"),k=a("frameheight");class P{constructor(e,t,i,s){void 0===t&&(t=1),void 0===i&&(i=1),void 0===s&&(s=t*i),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),this.getWidth=()=>n(this,R)[R].width/n(this,O)[O],this.getHeight=()=>n(this,R)[R].height/n(this,C)[C],this.nextFrame=()=>{n(this,B)[B]<n(this,b)[b]-1?n(this,B)[B]++:n(this,B)[B]=0},this.draw=(e,t,i,s,r)=>{const o=n(this,R)[R],a=n(this,U)[U],l=n(this,k)[k],h=n(this,B)[B]%n(this,O)[O]*a,A=Math.floor(n(this,B)[B]/n(this,O)[O])*l;s||(s=o.width),r||(r=o.height),e.drawImage(o,h,A,a,l,t,i,s,r)},"undefined"!=typeof Image&&(n(this,R)[R]=new Image,n(this,R)[R].src=e,n(this,O)[O]=t,n(this,C)[C]=i,n(this,b)[b]=s,n(this,R)[R].addEventListener("load",(()=>{n(this,U)[U]=n(this,R)[R].width/n(this,O)[O],n(this,k)[k]=n(this,R)[R].height/n(this,C)[C],n(this,B)[B]=0})))}}var x=a("sprite"),D=a("world");class I{constructor(e,t,i){var s=this;let{labels:r,size:o=1,keyBinds:a,spriteSrc:l,framesPerRow:h,framesPerColumn:A,framesCount:c}=void 0===i?{}:i;Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),this.setAngle=e=>this.angle=Math.PI/180*e,this.setExistingWorld=e=>n(this,D)[D]=e,this.isKey=e=>this.keys.is(e),this.isKeyOnce=e=>this.keys.isOnce(e),this.getWorld=()=>n(this,D)[D],this.getTilePos=function(e,t){return void 0===e&&(e=s.x),void 0===t&&(t=s.y),{x:Math.floor(e+s.w/2),y:Math.floor(t+s.h/2)}},this.getThingImOn=()=>{var e,t;const i=this.getTilePos();return null===(e=n(this,D)[D])||void 0===e||null===(t=e.getCell(i.x,i.y))||void 0===t?void 0:t.top()},this.nextFrame=()=>n(this,x)[x].nextFrame(),this.draw=function(e,t,i,r,o,a){var l;void 0===i&&(i=s.x),void 0===r&&(r=s.y),void 0===o&&(o=s.w),void 0===a&&(a=s.h);const h=o*t,A=a*t,c=h/2,d=A/2;e.save(),e.translate((i+.5)*t,(r+.5)*t),e.rotate(-s.angle),null===(l=n(s,x)[x])||void 0===l||l.draw(e,-c,-d,h,A),e.restore()},this.tick=e=>{},this.labels=r,this.keys=new E(a),n(this,x)[x]=l?new P(l,h,A,c):null,this.x=e,this.y=t,this.w=o,this.h=o}setSize(e,t){void 0===t&&(t=e),this.w=e,this.h=t}}class F extends I{constructor(e,t,i){let{size:s=.5}=void 0===i?{}:i;super(e,t,{size:s,spriteSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAASElEQVQoU2OUTmT4z0AkYAQpFvdiQVH+ctsfBmxipClOZGD4343mjFIGBgZsYowkKybSfwykm0w7NxNtMshzoBAh5Mn5DAyMACdJKB0tutaFAAAAAElFTkSuQmCC"}),this.tick=()=>{}}}var S=a("gifts");class z extends I{constructor(e,t,i){let{size:s=1.5}=void 0===i?{}:i;super(e,t,{size:s,spriteSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABEFJREFUWEe9V81LVFEUPzNqo6O+MVFmhEFBg8pVQtLGheVOhBgiQog2IeHf0F/gukW0iKiNUAsNRFeagYvAxJ0f4QeGMsqYzTxpZrT0xe8453rfnfdGJenAcN+7H+f8zu983DcB8hanMB0ojOa7z7GLT4sB86TzLJGgVyMjPN/T2UmTs7N4xH4B42fNT6fnfl8AT3p7XQfejY/z+7JlUfPAAB2OjpJj2xSMx3n8urNDt6NRim5tUT6fl7NnginJwJ5tU+7ggH9gwO7ooOWVFbrZ3U2L09MUDwbJdhyKhkI0l8vxOwTvucNDaspkzgRSkgEBAC0AkIxEWKGm2MUS1sMNDRSwLDUPwJ37+75AvABwjB/29LDnALGVStFGMqmUJocjVFV5xWU8lz+kpn7lMU3W1ChGFo6O6F4sRpHVVckjddYE4KQbG6kulaK+ri7eNDYzwyOM6mICMDOsLpHiKegTQb5Y8/MuEDoAhxNscJCqhoZc3pqGRblpND1yagyMcLj6MxSLxehzNktWIEBg40F5OaXTabat6jzT1kZT29tMG2ImHlfXt9JxdvOUsgqLIn2rFE0znUp26toIAMoi7Tzn/LZ5/LW3poAgLO1lZVTd2krN6+sMgutaXwBFYlxoDlRYSiGe/QBkxtoUAIDG3qPMAgOQHEGiAsCLxUV6ns+fMBCLxZy1RILCL1+6Yu0FAPsRAj8GguG4YgDPwh7AgA2EBCAKlcQMiHD26xmOQ14CBrwEDMAozsGwAEA48DMqxZUDCoQAgBKhHodFGZQsfD+ieEOQovUhmvuW42crfOJLuLaB9wr1evg0AMrxojL0YgAAhI3s/i73ALzjGYJ3KIdxAS7U62HA/kKv8AeATNa99+S6kOVSaqgUxLcmessFQEBIRZyLAall8Vj3oBQYrEkCyj6zfM/NABRJ4kCZgNHjKbVulqh4KyD0RMZaoYmVzgGJq65ET0idCQHrxY4JRkpYa4CqE7qqwAuAHkfZjOTTaZfm42VY8qr50UkHVM4ZyB390tFvN9NDvVz9+oKc0RP7XACkrAAAX0ZVoRBfydficR4/TE66GpZXZxTjuCN0sC2Pf5RmQKpASgbfhvgugGCstyx6OzFB28O1qlGdBcDU6ZsDlZWVDhSzscIHhjAgADC+n5r6fwCEAYRBRBiQCvC6HfUQXAoDoB8gMOILGXFF64X8M4Ab4y3OUu9GACFYfxPi3r6zd0DXn9qk/z+QcOD/gmS2APDrkpj3qCx3GQoAtHgo1j+nzBAIA0IrgOJWlLzRewjWcEtu7h6r2xJOFSUhAGB2qXejCC0A6AmIMJgMYP1O8A/v+5RJKzLs7MmfKLmq8Vx0G4pxAbD82qL7TVfpY/Inh0CvAtEMAKD1bqSOvhxkmTE8m4I1EZ1VFwM6AF0BcqJUXP3OlTpjrsEGGzFYOPP/nCi6DBDnNnYRzy6y9y9HbbU6yUzbiAAAAABJRU5ErkJgggAA"}),Object.defineProperty(this,S,{writable:!0,value:[]}),this.pushGift=e=>{n(this,S)[S].push(e)},this.tick=()=>{}}}var L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAzElEQVRYR+2W7wmAIBDFz8ZpB6FFa4GWCNqhdYoTCwv1/C+kfgoy73fvXvjYuvATKi6mA2AAUIpKC/AVJCeQE4BtQtt+wMTH4CG+AHw7jS2O1A+AqbgvlK8UAqBacVUBX/JU+58RpJhnCNTLhDUgon9DqmuqqewAFGAH6ApkU4By/21OEsD1IMrtpvckQOjBrt91gIYVwNQ7yESETscVk+2sppPFRNRWn0UgmfmJJEVyOBbH+KWshj0gVWhbAbRDEgVi7ot/ALhePLp9F13HfMS22AqGAAAAAElFTkSuQmCC",T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAUdJREFUWEftlr8KwjAQxlOnjh37DM6OVhREEERwdPHNVHARVBDESQQFV2efo2O3yhfa0tS2yfVfBhsoLfS4++W7y+WM48bxmcZlpAEYjLGmqFIBkoLUCaQEkJeh5+vDhk63cBIFAOpOywYHdQSQFZwKRZWCA2gLHleASl6VfZSCKvJZBEooQh0QpY+hbNeyTdUOIANsAf5TgfHiwu7nOS+P2hTIqv7Z8sYDX/cTNQDZMZJVefJ/b7Rjtm2rA1ADUO1rS4EqSAugTwFMvZ3gGKLSscrMdrk5D4LxUTv+zfvA2vFB0sgcjuAYv2JLXwoCiFQAtErXdYWGoXqsqHYCALqUZVnch+d5HOC0HVB9kuwFgP70wEzT5A7whgoACvs2ybOCMcohFSCEgApY4c2V5bPMffFTA1AhVAAAeN6PVe5+KgVQUK5Sky+Or6bEQU31dwAAAABJRU5ErkJgggAA",j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAeNJREFUWEfllz9LxEAQxTdiEbRJcUjK1GJpIxhREMFGULQWBRsRrPwyigoWFv4FO0FEtPMD2BqswmGRwiLdyVsyYZLb3dwmeldk4UjuNtn325k3y5xzfRb2xAiHowJwhBDDolIClAPyn0ADAZgy9PL2IRbD6dpJLADY7rSpOKhzAJ24LZRtKCSArfjs0oXU8TxPPN2v2Wrmz0PXygObO68iiiIp7LquSJJEXvEd4+Z8wRomBzDl8/PrR+wdPkuxNE1zERKO41j+5vu+NUQhAioI7Bqi2C0EcQ8Q1eBzgAqCoBJIm4KZueNCeEnUBAAomgcwInKw2zGWaR8A5RmC9CnvlkPQPaUGwtj5oJ7IAZDnre273GBYgEym2zUXL0eIgCgVumoxVgGiQRBYiER4ZFTRoFTgenmyIqY6as8UDiKVqbrfqdg/eu+b4pVAk9ykVB38RV2JWp0DfMHl9QetR8rEpvOhFgBSQ2GuqgqkqxGA7mwgb/Ddchgqw6pqqBUBLEpRgDkp52VDVhmw0oQ2B/v86lXBE/xAerzdEJMT48rlakfABs70bIsB0PWOZf0AnI7RpLczpiQTk602v5cNyWnYA8lQ+nCIow1io8UeyKLQ7ghYd8U6pzf5g/InKRg5QJNj+RfTySfTlUlN/gAAAABJRU5ErkJgggAA";const Q=()=>{const e=Math.random();return e>.9?j:e>.6?T:L};class K extends I{constructor(e,t,i){let{size:s=1}=void 0===i?{}:i;super(e,t,{size:s,spriteSrc:Q()}),this.tick=()=>{}}}var M=a("entities");class V{get count(){return n(this,M)[M].length}constructor(e){Object.defineProperty(this,M,{writable:!0,value:[]}),this.name=e}push(e){n(this,M)[M].push(...e)}pop(e){return n(this,M)[M].splice(-e)}}var N=a("data");class W{constructor(){var e=this;Object.defineProperty(this,N,{writable:!0,value:{}}),this.remove=function(t,i){return void 0===i&&(i=1),n(e,N)[N][t].pop(i)},this.getData=()=>Object.values(n(this,N)[N])}add(){const e=n(this,N)[N];for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];i.forEach((t=>{let{entities:i,name:s}=t;s in e||(e[s]=new V(s)),e[s].push(i)}))}}class J extends I{}var Y=a("data");class G{constructor(e,t,i){Object.defineProperty(this,Y,{writable:!0,value:[]}),n(this,Y)[Y]=i,this.x=e,this.y=t}getData(){return[...n(this,Y)[Y]]}put(e){e&&n(this,Y)[Y].push(e)}top(){var e;return null!==(e=n(this,Y)[Y][n(this,Y)[Y].length-1])&&void 0!==e?e:new J(this.x,this.y)}forEach(e){n(this,Y)[Y].forEach(((t,i)=>e(t,i)))}take(){var e;return null!==(e=n(this,Y)[Y].pop())&&void 0!==e?e:null}}let q=function(e){return e[e.WALL=0]="WALL",e[e.AIR=1]="AIR",e}({});var H=a("inventory");class Z extends I{constructor(e,t,i){var s;let{cantMoveOn:r=[],labels:o,size:a,keyBinds:l,spriteSrc:h,framesPerRow:A,framesPerColumn:c,framesCount:d}=i;super(e,t,{labels:o,size:a,keyBinds:l,spriteSrc:h,framesPerRow:A,framesPerColumn:c,framesCount:d}),s=this,Object.defineProperty(this,H,{writable:!0,value:new W}),this.speed=.2,this.cantMoveOn=[{type:q.WALL,tileType:J}],this.setSpeed=e=>this.speed=e,this.getInventory=()=>n(this,H)[H].getData(),this.addToInventory=function(){n(s,H)[H].add(...arguments)},this.removeFromInventory=function(e,t){return void 0===t&&(t=1),n(s,H)[H].remove(e,t)},this.takeFromWorld=()=>{var e;const t=this.getTilePos();return null===(e=this.getWorld())||void 0===e?void 0:e.takeFromTop(t.x,t.y)},this.goUp=function(e){void 0===e&&(e=s.speed),s.setAngle(90),s.go(e)},this.goDown=function(e){void 0===e&&(e=s.speed),s.setAngle(270),s.go(e)},this.goRight=function(e){void 0===e&&(e=s.speed),s.setAngle(0),s.go(e)},this.goLeft=function(e){void 0===e&&(e=s.speed),s.setAngle(180),s.go(e)},this.go=function(e){void 0===e&&(e=s.speed);const t=s.getTilePos(),i=s.x+Math.cos(s.angle)*e,r=s.y-Math.sin(s.angle)*e,n=Math.sign(i-s.x),o=Math.sign(r-s.y),a=s.getTilePos(i,r),l=s.getWorld(),h=(e,t)=>l.getCell(e,t).top(),A=[h(a.x,a.y)];i!=s.x&&A.push(h(t.x+n,t.y-1),h(t.x+n,t.y+0),h(t.x+n,t.y+1)),r!=s.y&&A.push(h(t.x-1,t.y+o),h(t.x+0,t.y+o),h(t.x+1,t.y+o));A.some((e=>{const t=s.cantMoveOn.find((t=>e instanceof t.tileType));if(!t)return!1;switch(t.type){case q.AIR:return a.x===e.x&&a.y===e.y;case q.WALL:return Z.checkCollisionAABB({x:i,y:r,w:.9*s.w,h:.9*s.h},e)}}))||(s.x=i,s.y=r)},this.tick=e=>{throw new Error('You should override method "tick"')};const u=r.map((e=>"type"in e&&"tileType"in e?e:{type:q.WALL,tileType:e}));this.cantMoveOn.push(...u)}static checkCollisionAABB(e,t){const i=e.x-e.w/2,s=e.y-e.h/2,r=t.x-t.w/2,n=t.y-t.h/2;return i<r+t.w&&i+e.w>r&&s<n+t.h&&s+e.h>n}}const X=Math.random()>.5?"santa":"frost";class _ extends Z{constructor(e,t,i){let{speed:s=.2,size:r}=void 0===i?{}:i;super(e,t,{cantMoveOn:[],labels:["player"],size:r,spriteSrc:"frost"===X?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA6tJREFUWEfFlstrE1EUxr9pm2Ym7WRStUkai1bTEFoRtFp8goouVFQQRBeiC12JCIIrEdyJf4EIggo+ViIuFN+lFqxUtC1aqNYy1EeVxHYxSZtH0ebKOXRK1GruJEUvDJnJ3HvO73znnHtHQYERsEwx05S4L6wUWivz/o9GMpmMCAy/huLVIZJj/GsP+zkRaC4Z4o8GhBDCsizU1NQo3sHnggAm+wdQVh9ioKHgLlRVz4VmfCoJQnqxEe8XueEvGIkcZyFyuY8INZTBsixpGzOlRHqx+VYVhl4G3diIsWQ7qvUW5Cb74PElpW2UBECLR79oQtdbIEQCwQXDFD39/e8A0pZXKIqBVGoUHo+r5Ogd0ft8PtHdlcX8UCPnP53+hnmhjK1q0SrILhTewefcinFtL6egQTxB4vwluA/tRyLQXDSINIAR74df1ZAUOXaWGRnldqS2tPxN8Pa0oXzzHsddURCApHe/70Z2YgLlTesx+eYpVLcbI3MiqHrxkFXRaudhvKMT47sOQFHYZEG70pKpqipcnXfYUcWqbT8BeNpuorw5ykCp3teoa1mGQWPR7AIA4PzTaNx3BOa9a9MK5AOkzSEEG8N4521wpIKMVNMFOHfNDqR6HjGMnQKqAVuB6IoWDMZjSEZWSasgBRBJDOFrNoOq5VuQ6n3MxUhS692P+XzQd27loqRaeCvm0PkxuwABy4RXKcPnuiWoeNWOgN/PANQZ1AnkmACoTkgNKtip1iwY4F8nUAFW9nWw5JFAEG+CTXANveRnJboWYuAZ6ICyT0gCofHeHYKmaVIqFARwf+hhmf2HT8A0TXZAZ4DP5+NiowIlFTzhRawS7ROkhmwdSAGQA1sB86ILybRA9HASlBoaY7fvcx2Q9JSCmLFYuhP+CkCbUO7FA85xc3klOoyF+Hxdx/BoDq3HxrgISf7vXS9RsXolw+R9LZWegvxdkKzl7fnszHP1HDumFFEBEow9ZiUFBPD91mU2bH+S0c5HUdJFw3ZKKlRvWJffAaUrMBWNCAaDXHjZbHY6QvtGVVW+pXd0nzenYAtKEf7mERAkffrA0WLX/2RSivIXCEEbkOxGM0MApQNUt9/C+Kbd/08B9ewpZE+esSMpRsVpFZwuFsujUfQODODg9u3ITEzgRlsbqEhjsZhTWwzhdJHY3NqK+bW17PwbABeApeEwTl+4UJQijgEW1tWxQ83tZgi6aNBvY309rty96ygwxwCFqnrqvbRd6YmSjh1P+wGZ/okw2xUmaAAAAABJRU5ErkJgggAA":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAqlJREFUWEfFlk+L00AYxp9pm7bZtkld6P5xBQUPuoI9WRTBU8FD754Ev4afxQ/gyUM/QUHwohYPenBZYUFd10tBkzTbTdpuRt5JJ1u6dTPTVnegMCTzvvOb533mTRlShlOrcWZZoB/3vGS1fXDA0mJV3v81CeecuxsbIsfJcDg317brLg1xIUAQBDBNk+1bFp8lyL2PoW7eDpaCUA6WpTA+9BKW9a0hguA/AQwcizNmi805d5HJ3gWPvsO0D5UPMa+OWsESggCu3siIfI7jaOWYhdAKDv0W7/uvYRqbQO43SvZymxOMMkC1WuU/v0YYDEZYWzNA5biy2SMPaOVZSIFiscg/5vOwGIOxF7t/tJuHx+PLceusPygfSIKoBvBupYJrmbjucvyIIjG953n4YtsSRDWniFVZLDan0+/6Po4qFRG40+9jr1wWc6kEgTAmUqrkVQfYtyyxeBbgXakkwOQgkEa/v3oAUoDG/ePjcwrI00sIXRVUpOKqChAEKbLtusoqKAGoeIA2JjX+mQKUPK0EBCE9oapCmgK8XSrhTjY714TyFtDLz6enYh0BbDmO8m1IBZAGJHfzSeNJmghjIH9MG1H2ipUpIOuflODlpA88jfsAPZf1lyVYqQKdcjnpgKIPzADIRkRdkUrwdjzGY8NQvgmpJSAAaSwyIY1o0oJJHakAeeAwimAzhge5nHJDSgV4XiiIk0mDScPRiae7ID2X9W/6fmKTsy/H/FkaAEWd+z+YlnTyXiW3+kdjalP+DcD1+IHSJhcBL5KAfwJQv0yANwAeXSbAVAmWLoNuCXiz0UCn28WzVgtHvZ6Y65hu1g/aAE+aTZiFAk7CECMA4zDETq2GF+32QiDaAA/rdaxbVgLxy/OSOYG86nS0yqINsMoeoEWquLH2sj+JYDkwm7dDLgAAAABJRU5ErkJgggAA"}),this.score=0,this.tick=e=>{if(this.nextFrame(),this.move(e),this.isKeyOnce("q")){const e=this.getThingImOn();if(e instanceof F)this.addToInventory({name:"Prezent",entities:[this.takeFromWorld()]});else if(e instanceof z){const[i]=this.removeFromInventory("Prezent");if(i){var t;e.pushGift(i),this.score+=10;const s=null!==(t=Number(localStorage.getItem(X)))&&void 0!==t?t:0;localStorage.setItem(X,`${this.score+s}`)}}}},this.move=e=>{const t=this.isKey("leftDirection"),i=this.isKey("rightDirection"),s=this.isKey("upDirection"),r=this.isKey("downDirection");let n=!1;const o=e=>{n=!0,this.setAngle(e)};s?o(i?45:t?125:90):r?o(i?-45:t?-125:-90):t?o(180):i&&o(0),n&&this.go(this.speed*e)},s&&this.setSpeed(s)}}var $=a("script"),ee=a("width"),te=a("height"),ie=a("data"),se=a("configureEntity");var re=new class{get width(){return n(this,ee)[ee]}get height(){return n(this,te)[te]}constructor(e){let{script:t,symbolDefs:i,board:s,tileSize:r=32}=e;this.entities=[],this.tileSize=32,Object.defineProperty(this,$,{writable:!0,value:void 0}),Object.defineProperty(this,ee,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),Object.defineProperty(this,ie,{writable:!0,value:void 0}),this.setGame=e=>{this.game=e},Object.defineProperty(this,se,{writable:!0,value:e=>{if("function"==typeof(null==e?void 0:e.setExistingWorld)&&(null==e||e.setExistingWorld(this)),!(e instanceof Z))return e;this.entities.push(e)}}),this.runScript=()=>n(this,$)[$](this),this.spawn=e=>{const{x:t,y:i}=e.getTilePos();return n(this,se)[se](e),this.getCell(t,i).put(e),e},n(this,ee)[ee]=0,n(this,te)[te]=0,this.tileSize=r,n(this,$)[$]=t,n(this,ie)[ie]=s.map(((e,t)=>{const s=e.reduce(((e,t)=>"string"==typeof t?[...e,...t.split("")]:[...e,t]),[]);return s.length>n(this,ee)[ee]&&(n(this,ee)[ee]=s.length),s.map(((e,s)=>{const r=(Array.isArray(e)?e:[e]).flatMap((e=>e.split("").map((e=>{const r=e in i?i[e](s,t):null;return(Array.isArray(r)?r:[r]).map((e=>n(this,se)[se](e)))})))).flat().filter((e=>void 0!==e));return new G(s,t,r)}))})),n(this,ie)[ie].length>n(this,te)[te]&&(n(this,te)[te]=n(this,ie)[ie].length)}getCell(e,t,i){var s;void 0===i&&(i=!1);const r=null===(s=n(this,ie)[ie][t])||void 0===s?void 0:s[e];if(r||i)return r;n(this,ie)[ie][t]||(n(this,ie)[ie][t]=[]);const o=new G(e,t,[]);return n(this,ie)[ie][t][e]=o,o}forEach(e){n(this,ie)[ie].forEach(((t,i)=>t.forEach(((t,s)=>e(t,s,i)))))}getEntities(e){return e?this.entities.filter((t=>t.labels.some((t=>t===e)))):this.entities}takeFromTop(e,t){var i,s,r;return null!==(i=null===(s=n(this,ie)[ie][t])||void 0===s||null===(r=s[e])||void 0===r?void 0:r.take())&&void 0!==i?i:null}}({symbolDefs:{X:(e,t)=>null," ":(e,t)=>new K(e,t),g:(e,t)=>new F(e,t),P:(e,t)=>new _(e,t),H:(e,t)=>[new K(e,t),new z(e,t)]},board:[["        XX"],["          "],["          "],["          "],["          "],[" H        "],["          "],["          "],["X      X  "],["XX        "]],async script(e){const t=e.spawn(new _(1,1)),i=()=>Math.floor(10*Math.random()),s=function(e){return void 0===e&&(e=1e3),new Promise((t=>setTimeout(t,e)))};for(e.game.setActiveEntity(t);;){let t;for(let s=0,r=!1;s<10&&!r;++s){const s=e.getCell(i(),i(),!0);if(1===s.getData().filter((e=>e instanceof K)).length){t=s;break}}t&&e.spawn(new F(t.x,t.y)),await s(5e3)}}}),ne=a("mainLoopAnimationId"),oe=a("framesIntervalId"),ae=a("painter"),le=a("keys"),he=a("lastTick"),Ae=a("lastRender"),ce=a("tickLength"),de=a("loop");class ue{constructor(){var e=this;Object.defineProperty(this,ne,{writable:!0,value:void 0}),Object.defineProperty(this,oe,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:new g}),Object.defineProperty(this,le,{writable:!0,value:new E}),Object.defineProperty(this,he,{writable:!0,value:performance.now()}),Object.defineProperty(this,Ae,{writable:!0,value:n(this,he)[he]}),Object.defineProperty(this,ce,{writable:!0,value:50}),this.setCanvas=function(t,i){void 0===i&&(i=0),n(e,ae)[ae].setCanvas(t,i)},Object.defineProperty(this,de,{writable:!0,value:function(t){var i;void 0===t&&(t=0),n(e,ne)[ne]=null===(i=l())||void 0===i?void 0:i.requestAnimationFrame(n(e,de)[de]);const s=n(e,he)[he],r=n(e,ce)[ce];let o=0;if(t>s+r){const e=t-s;o=Math.floor(e/r)}for(var a=0;a<o;a++)n(e,he)[he]+=r,e.updateLogic(1-Math.floor((t-n(e,he)[he])/1e3));e.render()}}),this.startLevel=()=>{this.level=re,this.level.setGame(this),this.level.runScript()},this.setActiveEntity=e=>{this.activeEntity=e},this.startLoop=()=>{var e;n(this,ne)[ne]=null===(e=l())||void 0===e?void 0:e.requestAnimationFrame(n(this,de)[de])},this.stopLoop=()=>{var e,t;null===(e=l())||void 0===e||e.cancelAnimationFrame(n(this,ne)[ne]),null===(t=l())||void 0===t||t.clearInterval(n(this,oe)[oe])},this.updateLogic=e=>{if(!this.level)return;this.level.getEntities().forEach((t=>t.tick(e)))},this.render=()=>{this.level&&n(this,ae)[ae].drawLevel(this.level)},this.close=()=>{this.stopLoop(),n(this,ae)[ae].destroy()},this.startLevel(),this.startLoop()}}function ve(e){let{items:t}=e;return s.createElement("ul",null,t.map((e=>{let{count:t,name:i}=e;return s.createElement("li",{key:i,style:{marginLeft:20}},i,": ",t)})))}function ge(e){var t,i,r,n;let{game:o}=e;const{1:a}=(0,s.useState)(0),h=(0,s.useRef)(null),{activeEntity:A}=o;return(0,s.useEffect)((()=>{var e;return h.current=null===(e=l())||void 0===e?void 0:e.setInterval((()=>a(Date.now())),100),()=>{var e;return null===(e=l())||void 0===e?void 0:e.clearInterval(h.current)}})),A?s.createElement("ul",{style:{margin:10}},s.createElement("li",null,'Klikając "q" podnosisz prezent oraz przekazujesz go do domu'),s.createElement("li",null),A instanceof _&&s.createElement("li",null,"Punkty: ",A.score),s.createElement("li",null,"Punkty Mikołaja: ",null!==(t=null===(i=l())||void 0===i?void 0:i.localStorage.getItem("santa"))&&void 0!==t?t:0),s.createElement("li",null,"Punkty Mroza: ",null!==(r=null===(n=l())||void 0===n?void 0:n.localStorage.getItem("frost"))&&void 0!==r?r:0),s.createElement("li",null),A instanceof Z&&s.createElement("li",null,"Zawartość kieszeni: ",s.createElement(ve,{items:A.getInventory()})," ")):null}function fe(){const e=(0,s.useRef)(new ue);return(0,s.useEffect)((()=>e.current.close)),s.createElement("article",{className:"game-module--game--7256c"},s.createElement("canvas",{className:r,ref:t=>t&&e.current.setCanvas(t,0)}),s.createElement("canvas",{className:r,ref:t=>t&&e.current.setCanvas(t,1)}),s.createElement(ge,{game:e.current}))}var pe=i(8987),we=i(297);var me=(0,pe.A)({component:function(){return s.createElement(fe,null)},layout:we.A})}}]);
//# sourceMappingURL=component---src-pages-game-tsx-faeee4ba74086d402692.js.map